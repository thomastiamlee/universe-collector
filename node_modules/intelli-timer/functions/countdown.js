var async = require('async');


// task(timerCallback())
// callback(err)
var countdown = function(timeLimit, task, callback){
    async.parallel([
        function(asyncCallback){
            setTimeout(function(){
                asyncCallback('time out', null);
            }, timeLimit);
        },
        function(asyncCallback){
            task(function(){
                asyncCallback('finish', null);
            }); 
        }
    ],
    function(err, results){
        if(callback && typeof callback === 'function'){
            if(err === 'finish') callback(null);
            else callback('time insufficient');
        }
    });
};


/*
countdown(500, function(timerCallback){

    setTimeout(function(){
        console.log('123');
        timerCallback();
    }, 3000);

}, function(err){

    if(err) console.log(err);
    else console.log('success');

});
*/

module.exports = countdown;
